
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multidimensional Linear Regression &#8212; 2021 MSU REU Machine Learning Short Course</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">2021 MSU REU Machine Learning Short Course</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   2021 MSU REU Short Course on Machine Learning
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Schedule
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../schedule.html">
   Detailed Schedule
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Working with Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../day-1/Day-1_Getting-Started-with-Pandas.html">
   Getting Started with Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-1/Day-1_Getting-Started-with-Pandas-SOL.html">
   Solution - Getting Started with Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-1/Day-1_Exploring-data-with-Pandas.html">
   Exploring data with Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-1/Day-1_Exploring-data-with-Pandas-SOL.html">
   Solution - Exploring data with Pandas
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Modeling Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../day-2/Day-2_Polynomial_Regression.html">
   Polynomial Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-2/Day-2_Polynomial_Regression-SOL.html">
   Solution - Polynomial Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-2/Day-2_Multiple_Regression.html">
   Multidimensional Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-4/day-4_Pre-Class_regression.html">
   Day-4 Pre-Class Assignment: Polynomial Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day-4/day-4_In-Class_regression.html">
   Day 4 In-Class Assignment: Multidimensional Regression
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Acknowledgements
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../contributions.html">
   Contributions
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Admin/Day-2_Multiple_Regression_INSTRUCTOR.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dannycab/MSU_REU_ML_course/main?urlpath=lab/tree/notebooks/Admin/Day-2_Multiple_Regression_INSTRUCTOR.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jupyterhub.egr.msu.edu/hub/user-redirect/git-pull?repo=https://github.com/dannycab/MSU_REU_ML_course/docs/_build/html/index.html&urlpath=lab/tree/MSU_REU_ML_course/notebooks/Admin/Day-2_Multiple_Regression_INSTRUCTOR.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/dannycab/MSU_REU_ML_course/blob/main/notebooks/Admin/Day-2_Multiple_Regression_INSTRUCTOR.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goals">
   Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-imports">
   0. Our imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-example-data">
   1. Working with example data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#type-of-the-data">
     1.1 Type of the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#handling-missing-data-imputation">
     1.2 Handling missing data - Imputation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-numpy-nan">
       Using numpy.nan
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#changing-numpy-nan">
       Changing numpy.nan
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#what-do-you-think">
       What do you think
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression">
   2. Multiple Regression
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#infant-mortality-model">
     2.1 Infant Mortality model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-your-fit">
     2.2 Visualizing your fit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-reduced-model-using-only-the-significant-features">
     2.3 A “reduced” model using only the “significant” features
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="multidimensional-linear-regression">
<h1>Multidimensional Linear Regression<a class="headerlink" href="#multidimensional-linear-regression" title="Permalink to this headline">¶</a></h1>
<img src="https://assets.amuniversal.com/7f343ac0870a01332a13005056a9545d" width=400px><hr class="docutils" />
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>After completing this notebook, you will be able to:</p>
<ol class="simple">
<li><p>Read in a fixed width data set and assign column names</p></li>
<li><p>Clean missing data from a data set</p></li>
<li><p>Construct a set of linear regression model usings <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code></p></li>
<li><p>Evaluate the quality of fit for a set of models using adjusted <span class="math notranslate nohighlight">\(R^2\)</span> and by comparing true and predicted values</p></li>
<li><p>Explain why that model is the best fit for this data</p></li>
</ol>
</div>
<div class="section" id="our-imports">
<h2>0. Our imports<a class="headerlink" href="#our-imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span> <span class="k">as</span> <span class="nn">metrics</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="working-with-example-data">
<h2>1. Working with example data<a class="headerlink" href="#working-with-example-data" title="Permalink to this headline">¶</a></h2>
<p>We are going to work with some data generated by U.N.E.S.C.O. (United Nations Education, Scientific, and Cultural Organization) and data they collected relating to poverty and inequality in the world. There are two files you need to do the work:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">poverty.dat</span></code> which is the data file itself</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poverty.txt</span></code> which describes the data columns as <strong>fixed width column</strong> data. That is, this file describes the columns of the data for each category. For example, the data in columns 1-6 of <code class="docutils literal notranslate"><span class="pre">poverty.dat</span></code> contain the “live birth rates per 1,000 population”.</p></li>
</ul>
<p>Conveniently there is a fixed width column pandas data reader called <code class="docutils literal notranslate"><span class="pre">read_fwf</span></code> (<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_fwf.html">Documentation</a>). You will need to specific column names also. No column headers appear in this data file, so look at the <code class="docutils literal notranslate"><span class="pre">poverty.txt</span></code> file and give them short but useful names.</p>
<p><font size=8 color="#009600">✎</font> Do This - Read in the data into a DataFrame and print the <code class="docutils literal notranslate"><span class="pre">head()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">poverty_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s1">&#39;poverty.dat&#39;</span><span class="p">,</span> 
                         <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;birth rate&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;death rate&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;infant mortality&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;male LE&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;female LE&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;GNP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;country group&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;country&#39;</span><span class="p">])</span>
<span class="n">poverty_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>birth rate</th>
      <th>death rate</th>
      <th>infant mortality</th>
      <th>male LE</th>
      <th>female LE</th>
      <th>GNP</th>
      <th>country group</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24.7</td>
      <td>5.7</td>
      <td>30.8</td>
      <td>69.6</td>
      <td>75.5</td>
      <td>600</td>
      <td>1</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.5</td>
      <td>11.9</td>
      <td>14.4</td>
      <td>68.3</td>
      <td>74.7</td>
      <td>2250</td>
      <td>1</td>
      <td>Bulgaria</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.4</td>
      <td>11.7</td>
      <td>11.3</td>
      <td>71.8</td>
      <td>77.7</td>
      <td>2980</td>
      <td>1</td>
      <td>Czechoslovakia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.0</td>
      <td>12.4</td>
      <td>7.6</td>
      <td>69.8</td>
      <td>75.9</td>
      <td>*</td>
      <td>1</td>
      <td>Former_E._Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.6</td>
      <td>13.4</td>
      <td>14.8</td>
      <td>65.4</td>
      <td>73.8</td>
      <td>2780</td>
      <td>1</td>
      <td>Hungary</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="type-of-the-data">
<h3>1.1 Type of the data<a class="headerlink" href="#type-of-the-data" title="Permalink to this headline">¶</a></h3>
<p>Now look at the <code class="docutils literal notranslate"><span class="pre">.dtypes</span></code> of your DataFrame and describe to me anything unusual. Can you explain why? Please write below. Don’t skimp and look ahead, think about it and answer! We’ll all wait <font size=6 color="#009600">⏲</font></p>
<p><font size=8 color="#009600">✎</font> Answer here</p>
</div>
<div class="section" id="handling-missing-data-imputation">
<h3>1.2 Handling missing data - Imputation<a class="headerlink" href="#handling-missing-data-imputation" title="Permalink to this headline">¶</a></h3>
<p>Let’s face it, sometimes data is bad. Values are not recorded, or are mis-recorded, or are so far out of expectation that you expect there is something wrong. On the other hand, just <strong>changing</strong> the data seems like cheating. We have to work with what we have, and if we have to make changes it would be good to do that programmatically so that it is recorded for others to see.</p>
<p>The process of <a href="https://en.wikipedia.org/wiki/Imputation_(statistics)"> imputation </a> is the statistical replacement of missing/bad data with substitute values. We have that problem here. In the <strong>GNP</strong> column some of the values are set to ” * ” indicating missing data. When pandas read in the column the only type that makes sense for both characters and numbers is a string. Therefore it set the type to <code class="docutils literal notranslate"><span class="pre">object</span></code> instead of the expected <code class="docutils literal notranslate"><span class="pre">int64</span></code> or <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p>
<div class="section" id="using-numpy-nan">
<h4>Using numpy.nan<a class="headerlink" href="#using-numpy-nan" title="Permalink to this headline">¶</a></h4>
<p>For better or worse, pandas assumes that “bad values” are marked in the data as numpy <strong>NaN</strong>. NaN is short for “Not a Number”. If they are so marked we have access to some of the imputation methods, replacing NaN with various values (mean, median, specific value, etc.).</p>
<p>There are two ways to do this:</p>
<ol class="simple">
<li><p>you can do a <code class="docutils literal notranslate"><span class="pre">.replace</span></code> on the column using a dictionary of {value to replace : new value, …} pairs. Remember to save the result. This leaves you with changing the column type using <code class="docutils literal notranslate"><span class="pre">.astype</span></code> but you will have convert to a float, perhaps <code class="docutils literal notranslate"><span class="pre">&quot;float64&quot;</span></code> would be good. You cannot convert a <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> to an integer but you can to a float.</p></li>
<li><p>you can convert the everything that can be converted to a number using <code class="docutils literal notranslate"><span class="pre">.to_numeric</span></code>. Conveniently if it can’t do the conversion on a particular value it is set to a <code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></li>
</ol>
<p><font size=8 color="#009600">✎</font> Do This - Convert the missing entries in the GNP column to <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> and show the head of your modified DataFrame. Also print the <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> to show that the column has change type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">poverty_df</span><span class="p">[</span><span class="s1">&#39;GNP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">poverty_df</span><span class="p">[</span><span class="s1">&#39;GNP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poverty_df</span><span class="p">[</span><span class="s1">&#39;GNP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

<span class="n">poverty_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>birth rate          float64
death rate          float64
infant mortality    float64
male LE             float64
female LE           float64
GNP                 float64
country group         int64
country              object
dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="changing-numpy-nan">
<h4>Changing numpy.nan<a class="headerlink" href="#changing-numpy-nan" title="Permalink to this headline">¶</a></h4>
<p>Now that “bad values” are marked as <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>, we can use the DataFrame method <code class="docutils literal notranslate"><span class="pre">fillna</span></code> to change those values. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Uncomment to run</span>

<span class="n">poverty_df</span><span class="p">[</span><span class="s2">&quot;GNP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      600.0
1     2250.0
2     2980.0
3        0.0
4     2780.0
       ...  
92     220.0
93     110.0
94     220.0
95     420.0
96     640.0
Name: GNP, Length: 97, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>returns a new DataFrame where all the <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> in the GNP column are replaced with 0. You can do other things are well, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Uncomment to run</span>
<span class="n">poverty_df</span><span class="p">[</span><span class="s2">&quot;GNP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">poverty_df</span><span class="p">[</span><span class="s2">&quot;GNP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">)</span>
<span class="n">poverty_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">({</span><span class="s2">&quot;GNP&quot;</span><span class="p">:</span> <span class="n">poverty_df</span><span class="p">[</span><span class="s2">&quot;GNP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>birth rate</th>
      <th>death rate</th>
      <th>infant mortality</th>
      <th>male LE</th>
      <th>female LE</th>
      <th>GNP</th>
      <th>country group</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24.7</td>
      <td>5.7</td>
      <td>30.8</td>
      <td>69.6</td>
      <td>75.5</td>
      <td>600.000000</td>
      <td>1</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.5</td>
      <td>11.9</td>
      <td>14.4</td>
      <td>68.3</td>
      <td>74.7</td>
      <td>2250.000000</td>
      <td>1</td>
      <td>Bulgaria</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.4</td>
      <td>11.7</td>
      <td>11.3</td>
      <td>71.8</td>
      <td>77.7</td>
      <td>2980.000000</td>
      <td>1</td>
      <td>Czechoslovakia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12.0</td>
      <td>12.4</td>
      <td>7.6</td>
      <td>69.8</td>
      <td>75.9</td>
      <td>5741.252747</td>
      <td>1</td>
      <td>Former_E._Germany</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.6</td>
      <td>13.4</td>
      <td>14.8</td>
      <td>65.4</td>
      <td>73.8</td>
      <td>2780.000000</td>
      <td>1</td>
      <td>Hungary</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92</th>
      <td>52.2</td>
      <td>15.6</td>
      <td>103.0</td>
      <td>49.9</td>
      <td>52.7</td>
      <td>220.000000</td>
      <td>6</td>
      <td>Uganda</td>
    </tr>
    <tr>
      <th>93</th>
      <td>50.5</td>
      <td>14.0</td>
      <td>106.0</td>
      <td>51.3</td>
      <td>54.7</td>
      <td>110.000000</td>
      <td>6</td>
      <td>Tanzania</td>
    </tr>
    <tr>
      <th>94</th>
      <td>45.6</td>
      <td>14.2</td>
      <td>83.0</td>
      <td>50.3</td>
      <td>53.7</td>
      <td>220.000000</td>
      <td>6</td>
      <td>Zaire</td>
    </tr>
    <tr>
      <th>95</th>
      <td>51.1</td>
      <td>13.7</td>
      <td>80.0</td>
      <td>50.4</td>
      <td>52.5</td>
      <td>420.000000</td>
      <td>6</td>
      <td>Zambia</td>
    </tr>
    <tr>
      <th>96</th>
      <td>41.7</td>
      <td>10.3</td>
      <td>66.0</td>
      <td>56.5</td>
      <td>60.1</td>
      <td>640.000000</td>
      <td>6</td>
      <td>Zimbabwe</td>
    </tr>
  </tbody>
</table>
<p>97 rows × 8 columns</p>
</div></div></div>
</div>
<p>The first version changes any <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> in the <code class="docutils literal notranslate"><span class="pre">GNP</span></code> column to be the mean of the column. The second takes a dictionary where the the key of the dictionary is the column to change and the value is what to replace the <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> with. Note you could replace with other values like: median, min, max, or some other fixed value.</p>
<p>Remember that all of these examples return either a new Series (when working with just a column) or a DataFrame (if working with the entire element). Nothing is changed in the original unless you assign the result or use <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> in the call.</p>
<p>Finally, if you decide that the right thing to do is <strong>remove</strong> any row with a <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> value, we can use the <code class="docutils literal notranslate"><span class="pre">.dropna</span></code> method of DataFrames as shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Uncomment to run</span>
<span class="nb">len</span><span class="p">(</span><span class="n">poverty_df</span><span class="p">)</span>
<span class="n">poverty_df_dropped</span> <span class="o">=</span> <span class="n">poverty_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poverty_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">poverty_df_dropped</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97 91
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="what-do-you-think">
<h4>What do you think<a class="headerlink" href="#what-do-you-think" title="Permalink to this headline">¶</a></h4>
<p>In the cell below, discuss with your group what you think is the best thing to do with the “bad values” in the DataFrame given the discussion above. Write your result below.</p>
<p><font size=8 color="#009600">✎</font> Answer here</p>
</div>
</div>
</div>
<div class="section" id="multiple-regression">
<h2>2. Multiple Regression<a class="headerlink" href="#multiple-regression" title="Permalink to this headline">¶</a></h2>
<p>In the past, we have limited ourselves to either a single feature or, in the pre-class, doing polynomial regression with other features we created. However, we can just as easily use all, or some combination of all, the features available to make a OLS model. The question is, is it a good idea to just use all the possible features available to make a model?</p>
<p>Please discuss that idea with your group and record your answer below.</p>
<p><font size=8 color="#009600">✎</font> Answer here</p>
<div class="section" id="infant-mortality-model">
<h3>2.1 Infant Mortality model<a class="headerlink" href="#infant-mortality-model" title="Permalink to this headline">¶</a></h3>
<p>Using the U.N.E.S.C.O. data, we can make a model of “Infant Mortality” as the dependent variable against all the other available features. As a hint, an easy way to do this is the make the model with  “Infant Mortality” as the prediction (the dependent variable) and then the entire DataFrame where “Infant Mortality is dropped as the data (the independent variables). <strong>You should also drop the “Country” column as unique strings don’t play well in basic linear models.</strong></p>
<p><font size=8 color="#009600">✎</font> Do This - Make an linear model (did you split your data?) that predicts “Infant Mortality” using the other variables (dropping the “Country” column) and print the <code class="docutils literal notranslate"><span class="pre">.r2_score</span></code> of that process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">poverty_df_dropped</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;infant mortality&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">poverty_df_dropped</span><span class="p">[</span><span class="s1">&#39;infant mortality&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">linear</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">linear</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">linear</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span><span class="o">=</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r2: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2:  0.9401
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualizing-your-fit">
<h3>2.2 Visualizing your fit<a class="headerlink" href="#visualizing-your-fit" title="Permalink to this headline">¶</a></h3>
<p>We can check how well we are justified in using this model, by comparing the actual and predicted values. Plot the predicted values against the real values. In a perfect model, they would form a line with a slope of 1.</p>
<p><font size=8 color="#009600">✎</font> Do This - Make the plots mentioned above. How well does your model fit your data? What can you conclude from this graph?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;True Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># res = y_test-y_pred</span>

<span class="c1"># plt.figure(figsize=(5,5))</span>
<span class="c1"># plt.scatter(X_test[&#39;male LE&#39;], res)</span>
<span class="c1"># plt.xlabel(&#39;x&#39;)</span>
<span class="c1"># plt.ylabel(&#39;Residuals&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fce98142df0&gt;]
</pre></div>
</div>
<img alt="../../_images/Day-2_Multiple_Regression_INSTRUCTOR_27_1.png" src="../../_images/Day-2_Multiple_Regression_INSTRUCTOR_27_1.png" />
</div>
</div>
</div>
<div class="section" id="a-reduced-model-using-only-the-significant-features">
<h3>2.3 A “reduced” model using only the “significant” features<a class="headerlink" href="#a-reduced-model-using-only-the-significant-features" title="Permalink to this headline">¶</a></h3>
<p>Modeling data is as much a craft as it is a science. We often seek the simplest models that explain or data well because they are typically more interpretable, easier to explain, and provide the information on the main influences of the system we are studying. There are reasons we might want a more complex model to capture the details and the nuance of the system. But for the U.N.E.S.C.O. data that we have, we are likely able to capture most of the system using a smaller number of features.</p>
<p><font size=8 color="#009600">✎</font> Do This - use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> built=in correlation function (<code class="docutils literal notranslate"><span class="pre">.corr()</span></code>) to find the top 3 variables that correlate strongly with “Infant Mortality”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">poverty_df_dropped</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>birth rate</th>
      <th>death rate</th>
      <th>infant mortality</th>
      <th>male LE</th>
      <th>female LE</th>
      <th>GNP</th>
      <th>country group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>birth rate</th>
      <td>1.000000</td>
      <td>0.505626</td>
      <td>0.856537</td>
      <td>-0.866200</td>
      <td>-0.894440</td>
      <td>-0.629059</td>
      <td>0.710212</td>
    </tr>
    <tr>
      <th>death rate</th>
      <td>0.505626</td>
      <td>1.000000</td>
      <td>0.677741</td>
      <td>-0.754032</td>
      <td>-0.714751</td>
      <td>-0.302754</td>
      <td>0.344168</td>
    </tr>
    <tr>
      <th>infant mortality</th>
      <td>0.856537</td>
      <td>0.677741</td>
      <td>1.000000</td>
      <td>-0.935238</td>
      <td>-0.954225</td>
      <td>-0.601647</td>
      <td>0.631913</td>
    </tr>
    <tr>
      <th>male LE</th>
      <td>-0.866200</td>
      <td>-0.754032</td>
      <td>-0.935238</td>
      <td>1.000000</td>
      <td>0.981957</td>
      <td>0.642963</td>
      <td>-0.642059</td>
    </tr>
    <tr>
      <th>female LE</th>
      <td>-0.894440</td>
      <td>-0.714751</td>
      <td>-0.954225</td>
      <td>0.981957</td>
      <td>1.000000</td>
      <td>0.650040</td>
      <td>-0.699097</td>
    </tr>
    <tr>
      <th>GNP</th>
      <td>-0.629059</td>
      <td>-0.302754</td>
      <td>-0.601647</td>
      <td>0.642963</td>
      <td>0.650040</td>
      <td>1.000000</td>
      <td>-0.283399</td>
    </tr>
    <tr>
      <th>country group</th>
      <td>0.710212</td>
      <td>0.344168</td>
      <td>0.631913</td>
      <td>-0.642059</td>
      <td>-0.699097</td>
      <td>-0.283399</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font size=8 color="#009600">✎</font> Do This - Redo the model with only the top three features you found above vs “Infant Mortality”. Print the <code class="docutils literal notranslate"><span class="pre">.r2_score</span></code>, how does it compare to the full model?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">X1</span> <span class="o">=</span> <span class="n">poverty_df_dropped</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;infant mortality&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;country group&#39;</span><span class="p">,</span> <span class="s1">&#39;GNP&#39;</span><span class="p">,</span> <span class="s1">&#39;death rate&#39;</span><span class="p">])</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">poverty_df_dropped</span><span class="p">[</span><span class="s1">&#39;infant mortality&#39;</span><span class="p">]</span>

<span class="n">X_train1</span><span class="p">,</span> <span class="n">X_test1</span><span class="p">,</span> <span class="n">y_train1</span><span class="p">,</span> <span class="n">y_test1</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">linear</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="n">linear</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train1</span><span class="p">,</span><span class="n">y_train1</span><span class="p">)</span>

<span class="n">y_pred1</span> <span class="o">=</span> <span class="n">linear</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test1</span><span class="p">)</span>

<span class="n">r2</span><span class="o">=</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test1</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r2: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2:  0.8719
</pre></div>
</div>
</div>
</div>
<p><font size=8 color="#009600">✎</font> Do This -  Make the same comparison plot mentioned above. How well does your model fit your data? What can you conclude from this graph? Can you compare it to the previous fit?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ###</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;True Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Full Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Reduced Model&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># res = y_test-y_pred</span>

<span class="c1"># plt.figure(figsize=(5,5))</span>
<span class="c1"># plt.scatter(X_test[&#39;male LE&#39;], res)</span>
<span class="c1"># plt.xlabel(&#39;x&#39;)</span>
<span class="c1"># plt.ylabel(&#39;Residuals&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fce68085250&gt;]
</pre></div>
</div>
<img alt="../../_images/Day-2_Multiple_Regression_INSTRUCTOR_36_1.png" src="../../_images/Day-2_Multiple_Regression_INSTRUCTOR_36_1.png" />
</div>
</div>
<p>Review this model and the one you constructed earlier in the notebook. Report how the Adjusted R-squared value changed from using only the top three vs using all the available features. How well does this reduced model appear to fit your data?</p>
<p><font size=8 color="#009600">✎</font> Answer here</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/Admin"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Danny Caballero, Morten Hjorth-Jensen, Julie Butler, and Jane Kim<br/>
        
            &copy; Copyright 2021, Michigan State University.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>